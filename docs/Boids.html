<!DOCTYPE html>

<html>
<head>
  <title>Boid.cpp</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="Boids.html">
                Boids.cpp
              </a>
            
              
              <a class="source" href="Flocking.html">
                Flocking.cpp
              </a>
            
              
              <a class="source" href="main.html">
                main.cpp
              </a>
            
              
              <a class="source" href="testApp.html">
                testApp.cpp
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1 id="boid-cpp">Boid.cpp</h1>
<hr>
<h2 id="defines-boid-behaviour-">Defines Boid behaviour:</h2>
<ul>
<li>application of the Flocking Rules,</li>
<li>steering,</li>
<li>limit speed,</li>
<li>draw and update</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>

<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> &lt;iostream&gt;</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> "Boids.h"</span>


<span class="hljs-keyword">float</span> ofDist(<span class="hljs-keyword">float</span> x1, <span class="hljs-keyword">float</span> y1, <span class="hljs-keyword">float</span> z1, <span class="hljs-keyword">float</span> x2, <span class="hljs-keyword">float</span> y2, <span class="hljs-keyword">float</span> z2) {
	<span class="hljs-keyword">return</span> <span class="hljs-built_in">sqrt</span>(<span class="hljs-keyword">double</span>(( x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2) + (z1 - z2) * (z1 - z2))); <span class="hljs-comment">//rick</span>
}

Boid::Boid() {
    
    loc.x = ofRandom(-ofGetWidth(), ofGetWidth());
	loc.y = ofRandom(-ofGetHeight(), ofGetHeight());
	loc.z = ofRandom(-ofGetHeight(), ofGetHeight());
    
	vel.<span class="hljs-built_in">set</span>(<span class="hljs-number">0</span>);
	acc.<span class="hljs-built_in">set</span>(<span class="hljs-number">0</span>);
    r = <span class="hljs-number">5.0</span>;
    
    maxspeed = <span class="hljs-number">4</span>;
    maxforce = <span class="hljs-number">0.1</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <hr>
<h3 id="event">Event</h3>
<hr>
<p>   if(!bRegisteredEvents){
         ofRegisterMouseEvents(this);
         bRegisteredEvents = true;
     }</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>}</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <hr>

            </div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <h3 id="method-to-update-location">Method to update location</h3>
<hr>

            </div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">void</span> Boid::update(<span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;Boid*&gt;</span> boids) {
	
	flock(boids);</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Update velocity</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    vel += acc;</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Limit speed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    vel.x = ofClamp(vel.x, -maxspeed, maxspeed);
	vel.y = ofClamp(vel.y, -maxspeed, maxspeed);
    vel.z = ofClamp(vel.z, -maxspeed, maxspeed);
    
    loc += vel;</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Reset accelertion to 0 each cycle</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    acc.<span class="hljs-built_in">set</span>(<span class="hljs-number">0</span>);
    
	<span class="hljs-keyword">if</span> (loc.x &lt; -ofGetWidth()*<span class="hljs-number">2</span>-r) loc.x = ofGetWidth()+r;
    <span class="hljs-keyword">if</span> (loc.y &lt; -ofGetHeight()*<span class="hljs-number">2</span>-r) loc.y = ofGetHeight()+r;
    <span class="hljs-keyword">if</span> (loc.z &lt; -ofGetWidth()*<span class="hljs-number">2</span>-r) loc.z = ofGetHeight()+r;
    
    <span class="hljs-keyword">if</span> (loc.x &gt; ofGetWidth()*<span class="hljs-number">2</span>+r) loc.x = -r;
    <span class="hljs-keyword">if</span> (loc.y &gt; ofGetHeight()*<span class="hljs-number">2</span>+r) loc.y = -r;
    <span class="hljs-keyword">if</span> (loc.z &gt; ofGetHeight()*<span class="hljs-number">2</span>+r) loc.z = -r;
    
}</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <hr>

            </div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <h3 id="target">Target</h3>
<hr>

            </div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">void</span> Boid::setTarget(ofPoint target){</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>[TODO]</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    acc += steer(target, <span class="hljs-keyword">false</span>);
}

<span class="hljs-keyword">void</span> Boid::seek(ofPoint target) {
    acc += steer(target, <span class="hljs-keyword">false</span>);
}

<span class="hljs-keyword">void</span> Boid::arrive(ofPoint target) {
    acc += steer(target, <span class="hljs-keyword">true</span>);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <hr>
<p>A method that calculates a steering vector towards a target</p>
<h2 id="takes-a-second-argument-if-true-it-slows-down-as-it-approaches-the-target">Takes a second argument, if true, it slows down as it approaches the target</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>
ofPoint Boid::steer(ofPoint target, <span class="hljs-keyword">bool</span> slowdown) {</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>The steering vector</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    ofPoint steer;</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>A vector pointing from the location to the target</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    ofPoint desired = target - loc;</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Distance from the target is the magnitude of the vector</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">float</span> d = ofDist(target.x, target.y, target.z, loc.x, loc.y, loc.z);</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>If the distance is greater than 0, calc steering (otherwise return zero vector)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (d &gt; <span class="hljs-number">0</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Normalize desired</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		desired /= d;</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Two options for desired vector magnitude (1 — based on distance, 2 — maxspeed)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ((slowdown) &amp;&amp; (d &lt; <span class="hljs-number">100.0f</span>)) {
			desired *= maxspeed * (d/<span class="hljs-number">100.0f</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>This damping is somewhat arbitrary</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		} <span class="hljs-keyword">else</span> {
			desired *= maxspeed;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Steering = Desired minus Velocity</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		steer = desired - vel;</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Limit to maximum steering force</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		steer.x = ofClamp(steer.x, -maxforce, maxforce);
		steer.y = ofClamp(steer.y, -maxforce, maxforce);
		steer.z = ofClamp(steer.z, -maxforce, maxforce);
    }
    <span class="hljs-keyword">return</span> steer;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <hr>
<h1 id="draw">Draw</h1>
<hr>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">void</span> Boid::draw() {</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p> Draw a triangle rotated in the direction of velocity</p>
<pre><code> <span class="hljs-keyword">float</span> angle = (<span class="hljs-keyword">float</span>)<span class="hljs-built_in">atan2</span>(-vel.y, vel.x);
 <span class="hljs-keyword">float</span> theta =  -<span class="hljs-number">1.0</span>*angle;
 <span class="hljs-keyword">float</span> heading2D = ofRadToDeg(theta)+<span class="hljs-number">90</span>;
 ofEnableAlphaBlending();
 ofSetColor(<span class="hljs-number">255</span>);
 ofPushStyle();
 ofFill();

 ofSetColor(<span class="hljs-number">50</span>,boid_bright, boid_sat, <span class="hljs-number">5</span>);

 boid_bright = ofMap(loc.x,<span class="hljs-number">0</span>,ofGetWidth(), <span class="hljs-number">200</span>,<span class="hljs-number">0</span>);
 boid_sat = ofMap(loc.y,<span class="hljs-number">0</span>,ofGetHeight(), <span class="hljs-number">200</span>,<span class="hljs-number">0</span>);
</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <hr>

            </div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <h2 id="-target-test-"> Target (TEST)</h2>

            </div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <pre><code> ofPoint target(ofGetWidth()/<span class="hljs-number">2</span>, ofGetHeight()/<span class="hljs-number">2</span>, ofGetHeight()/<span class="hljs-number">2</span>);
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>    ofPoint target(ofRandomWidth(), ofRandomHeight(), ofRandomHeight());
    acc += steer(target, <span class="hljs-keyword">false</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>3D</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    glPushMatrix();
    glTranslated(loc.x, loc.y, loc.z);
    
    vel.normalize();</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <pre><code> ofVec3f forward(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>);
 ofVec3f axis = forward.crossed(vel);
 <span class="hljs-keyword">float</span> theta = acosf(forward.dot(vel));

 <span class="hljs-keyword">float</span> heading3D = ofRadToDeg(theta);
 glRotatef(heading3D, axis.x, axis.y, axis.z);
</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <pre><code> ofEnableLighting();
 pointLight.enable();
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>    
    ofColor(<span class="hljs-number">255</span>);
    sphere.setRadius(<span class="hljs-number">30</span>);
    ofSetSphereResolution(<span class="hljs-number">24</span>);
    
    ofDrawSphere(<span class="hljs-number">100</span>,<span class="hljs-number">100</span>, r);
    sphere.setScale(<span class="hljs-number">1.f</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <h3 id="2d-solution">2D Solution</h3>
<pre><code> ofPushMatrix();
 ofTranslate(loc.x, loc.y, loc.z);
 ofRotateZ(heading2D);
 ofBeginShape();
 ofVertex(<span class="hljs-number">0</span>, -r*<span class="hljs-number">2</span>);
 ofVertex(-r, r*<span class="hljs-number">2</span>);
 ofVertex(r, r*<span class="hljs-number">2</span>);
 ofEndShape(<span class="hljs-keyword">true</span>);
 ofPopMatrix();
 ofPopStyle();
 ofDisableAlphaBlending();
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>}</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <hr>

            </div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">void</span> Boid::flock(<span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;Boid*&gt;</span> boids) {
	ofPoint sep = separate(boids);
	ofPoint ali = align(boids);
	ofPoint coh = cohesion(boids);</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Arbitrarily weight these forces</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	sep *= <span class="hljs-number">1.5</span>;
	ali *= <span class="hljs-number">1.0</span>;
	coh *= <span class="hljs-number">1.0</span>;
	
	acc += sep + ali + coh;
	
}</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <hr>
<h3 id="separation">Separation</h3>
<p>Method checks for nearby boids and steers away</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
ofPoint Boid::separate(<span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;Boid*&gt;</span> boids) {
    <span class="hljs-keyword">float</span> desiredseparation = <span class="hljs-number">100.0f</span>;
    ofPoint steer;
    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>For every boid in the system, check if it’s too close</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span> ; i &lt; boids.size(); i++) {
		Boid* other = boids[i];
		
		<span class="hljs-keyword">float</span> d = ofDist(loc.x, loc.y, loc.z, other-&gt;loc.x, other-&gt;loc.y, other-&gt;loc.z);</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>If the distance is greater than 0 and less than an arbitrary amount (0 when you are yourself)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ((d &gt; <span class="hljs-number">0</span>) &amp;&amp; (d &lt; desiredseparation)) {</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Calculate vector pointing away from neighbor</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			ofPoint diff = loc - other-&gt;loc;
			diff /= d;			<span class="hljs-comment">// normalize</span>
			diff /= d;        <span class="hljs-comment">// Weight by distance</span>
			steer += diff;
			count++;            <span class="hljs-comment">// Keep track of how many</span>
		}
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>Average — divide by how many</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (count &gt; <span class="hljs-number">0</span>) {
		steer /= (<span class="hljs-keyword">float</span>)count;
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>As long as the vector is greater than 0
float mag = sqrt(steer.x<em>steer.x + steer.y</em>steer.y);</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	
	<span class="hljs-keyword">float</span> mag = <span class="hljs-built_in">sqrt</span>(steer.x*steer.x + steer.y*steer.y + steer.z*steer.z);
    <span class="hljs-keyword">if</span> (mag &gt; <span class="hljs-number">0</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>Implement Reynolds: Steering = Desired - Velocity</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		steer /= mag;
		steer *= maxspeed;
		steer -= vel;
		steer.x = ofClamp(steer.x, -maxforce, maxforce);
		steer.y = ofClamp(steer.y, -maxforce, maxforce);
		steer.z = ofClamp(steer.z, -maxforce, maxforce);
    }
    <span class="hljs-keyword">return</span> steer;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <hr>
<h3 id="alignment">Alignment</h3>
<p>For every nearby boid in the system, calculate the average velocity</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
ofPoint Boid::align(<span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;Boid*&gt;</span> boids) {
    <span class="hljs-keyword">float</span> neighbordist = <span class="hljs-number">100.0f</span>;
    ofPoint steer;
    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span> ; i &lt; boids.size(); i++) {
		Boid* other = boids[i];
		
		<span class="hljs-keyword">float</span> d = ofDist(loc.x, loc.y, loc.z, other-&gt;loc.x, other-&gt;loc.y, other-&gt;loc.z);
		<span class="hljs-keyword">if</span> ((d &gt; <span class="hljs-number">0</span>) &amp;&amp; (d &lt; neighbordist)) {
			steer += (other-&gt;vel);
			count++;
		}
    }
    <span class="hljs-keyword">if</span> (count &gt; <span class="hljs-number">0</span>) {
		steer /= (<span class="hljs-keyword">float</span>)count;
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>As long as the vector is greater than 0</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">float</span> mag = <span class="hljs-built_in">sqrt</span>(steer.x*steer.x + steer.y*steer.y + steer.z*steer.z);
    <span class="hljs-keyword">if</span> (mag &gt; <span class="hljs-number">0</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>Implement Reynolds: Steering = Desired - Velocity</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		steer /= mag;
		steer *= maxspeed;
		steer -= vel;
		steer.x = ofClamp(steer.x, -maxforce, maxforce);
		steer.y = ofClamp(steer.y, -maxforce, maxforce);
		steer.z = ofClamp(steer.z, -maxforce, maxforce);
        
    }
    <span class="hljs-keyword">return</span> steer;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <hr>
<h3 id="cohesion">Cohesion</h3>
<p> For the average location (i.e. center) of all nearby boids, calculate steering vector towards that location</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
ofPoint Boid::cohesion(<span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;Boid*&gt;</span> boids) {
    <span class="hljs-keyword">float</span> neighbordist = <span class="hljs-number">100.0f</span>;
    ofPoint sum;   <span class="hljs-comment">// Start with empty vector to accumulate all locations</span>
    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span> ; i &lt; boids.size(); i++) {
		Boid* other = boids[i];
		<span class="hljs-keyword">float</span> d = ofDist(loc.x, loc.y, loc.z, other-&gt;loc.x, other-&gt;loc.y, other-&gt;loc.z);
		<span class="hljs-keyword">if</span> ((d &gt; <span class="hljs-number">0</span>) &amp;&amp; (d &lt; neighbordist)) {
			sum += other-&gt;loc; <span class="hljs-comment">// Add location</span>
			count++;
		}
    }
    <span class="hljs-keyword">if</span> (count &gt; <span class="hljs-number">0</span>) {
		sum /= (<span class="hljs-keyword">float</span>)count;
		<span class="hljs-keyword">return</span> steer(sum, <span class="hljs-keyword">false</span>);  <span class="hljs-comment">// Steer towards the location</span>
    }
    <span class="hljs-keyword">return</span> sum;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <hr>

            </div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <pre><code> <span class="hljs-keyword">void</span> Boid::followMouse(ofPoint target) {
     acc += steer(target, <span class="hljs-keyword">false</span>);
 }
</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <pre><code> <span class="hljs-keyword">void</span> Boid::setTarget(ofPoint target){
     targetLoc =
 acc += steer(target, <span class="hljs-keyword">false</span>);
 }
</code></pre><hr>
<h2 id="-clickable"> CLICKABLE</h2>
<pre><code> <span class="hljs-keyword">void</span> Boid::mouseReleased(ofMouseEventArgs &amp; args){
 <span class="hljs-comment">// if the mouse is pressed over the circle an event will be notified (broadcasted)</span>
 <span class="hljs-comment">// the circleEvent object will contain the mouse position, so this values are accesible to any class that is listening.</span>
     ofVec2f mousePos = ofVec2f(args.x, args.y);
     ofNotifyEvent(clickableEvent, mousePos, <span class="hljs-keyword">this</span>);
 }
</code></pre><hr>

            </div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
